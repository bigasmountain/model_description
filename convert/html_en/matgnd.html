<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>MIROC-DOC matgnd</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="github-markdown.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->

<link rel="stylesheet" href="github.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    menuSettings: {locale: "ja"},
    extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
    TeX: {
      extensions: ["AMSmath.js", "AMSsymbols.js", "noErrors.js", "noUndefined.js"],
      noErrors: {disabled: true},
      noUndefined: {disabled: true}
    },
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [["$","$"] ],
      displayMath: [["$$","$$"]],
      processEscapes: true
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">MIROC-DOC matgnd</h1>
</header>
<h1 id="soil-submodel-matgnd">Soil Submodel MATGND</h1>
<p>Calculating soil temperature, soil moisture and frozen ground.</p>
<h2 id="calculating-heat-transfer-in-soil.">Calculating heat transfer in soil.</h2>
<h3 id="the-heat-transfer-equation-in-soil">The Heat Transfer Equation in Soil</h3>
<p>The prediction equation for soil temperature due to heat transfer in the soil is as follows.</p>
<p><span class="math display">$$
C_{g(k)} \frac{T_{g(k)}^* - T_{g(k)}^{\tau}}{\Delta t_L} = F_{g(k+1/2)} - F_{g(k-1/2)}
\qquad (k=1,\ldots,K_{g})
$$</span></p>
<p><span class="math inline"><em>C</em><sub><em>g</em>(<em>k</em>)</sub></span> is the heat capacity of the soil and is defined by</p>
<p><span class="math display"><em>C</em><sub><em>g</em>(<em>k</em>)</sub> = (<em>c</em><sub><em>g</em>(<em>k</em>)</sub> + <em>ρ</em><sub><em>w</em></sub><em>c</em><sub><em>p</em><em>w</em></sub><em>w</em><sub>(<em>k</em>)</sub>)<em>Δ</em><em>z</em><sub><em>g</em>(<em>k</em>)</sub></span></p>
<p><span class="math inline"><em>c</em><sub><em>g</em>(<em>k</em>)</sub></span> is the specific heat of the soil and is given as a parameter for each soil type. <span class="math inline"><em>c</em><sub><em>p</em><em>w</em></sub></span> is the specific heat of water and <span class="math inline"><em>w</em><sub>(<em>k</em>)</sub></span> is the soil water content (volume moisture content). <span class="math inline"><em>Δ</em><em>z</em><sub><em>g</em>(<em>k</em>)</sub></span> is the thickness of the <span class="math inline"><em>k</em></span> layer of soil. Thus, when the heat capacity of the soil is included in the heat capacity of the soil, the energy is not conserved unless the heat transport due to soil moisture transfer is taken into account. Since the heat transport associated with soil moisture transfer is not considered in MATGND, we are now discussing its introduction. However, it should be noted that the energy conservation is somehow broken unless the heat capacity of water vapor and precipitation in the atmosphere is taken into account.</p>
<p>The heat transfer flux <span class="math inline"><em>F</em><sub><em>g</em></sub></span> is given by</p>
<p><span class="math display">$$
 F_{g(k+1/2)} =
\left\{
\begin{array}{ll}
F_{g(1/2)} - \Delta F_{conv}^* - \Delta F_{c,conv}^*
 (k=0)\\
\displaystyle{
k_{g(k+1/2)} \frac{T_{g(k+1)} - T_{g(k)}}{\Delta z_{g(k+1/2)}}
}
 (k=1,\ldots,K_{g}-1) \\
\displaystyle{
0
}
 (k=K_{g})
\end{array}
\right.
$$</span></p>
<p>where <span class="math inline"><em>k</em><sub><em>g</em>(<em>k</em> + 1/2)</sub></span> is the thermal conductivity of the soil and is given as follows</p>
<p><span class="math display"><em>k</em><sub><em>g</em>(<em>k</em> + 1/2)</sub> = <em>k</em><sub><em>g</em>0(<em>k</em> + 1/2)</sub>[1 + <em>f</em><sub><em>k</em><em>g</em></sub>tanh (<em>w</em><sub>(<em>k</em>)</sub>/<em>w</em><sub><em>k</em><em>g</em></sub>)]</span></p>
<p><span class="math inline"><em>k</em><sub><em>g</em>0(<em>k</em> + 1/2)</sub></span> is the thermal conductivity of the soil when the soil moisture content is <span class="math inline">0</span>, and <span class="math inline"><em>f</em><sub><em>k</em><em>g</em></sub> = 6</span> and <span class="math inline"><em>w</em><sub><em>k</em><em>g</em></sub> = 0.25</span> are constants.</p>
<p><span class="math inline"><em>Δ</em><em>z</em><sub><em>g</em>(<em>k</em> + 1/2)</sub></span> is the thickness between the temperature definition point of the first <span class="math inline"><em>k</em></span> layer and the soil temperature definition point of the <span class="math inline"><em>k</em> + 1</span> layer (for <span class="math inline"><em>k</em> = 0</span>, it is the thickness between the temperature definition point of the first layer and the top of the soil, and for <span class="math inline"><em>k</em> = <em>K</em><sub><em>g</em></sub></span>, it is the thickness between the temperature definition point of the lowest layer and the bottom of the soil).</p>
<p>In (3), the boundary condition (<span class="math inline"><em>F</em><sub><em>g</em>(1/2)</sub></span>) is obtained by adding the energy convergence at the bottom edge of the snowpack (including the heat flux at the bottom edge of the snowpack) and the assignment of the energy correction term to the snow-free surface due to the phase change of water content in the canopy. The fluxes are given. The fluxes are positive upward and are negative when adding the convergence amount. The boundary condition <span class="math inline"><em>F</em><sub><em>g</em>(<em>K</em><sub><em>g</em></sub> + 1/2)</sub></span> at the lower edge of the soil is assumed to be zero flux.</p>
<h3 id="solving-the-heat-transfer-equation.">Solving the heat transfer equation.</h3>
<p>These equations are solved in terms of soil temperature from the first to the lowest layer using the implicit method. In other words, for <span class="math inline"><em>k</em> = 1, …, <em>K</em><sub><em>g</em></sub> − 1</span>, the heat transfer fluxes are estimated by</p>
<p><span class="math display">$$
  F_{g(k+1/2)}^{*} = F_{g(k+1/2)}^{\tau}
+\frac{\partial {F}_{g(k+1/2)}}{\partial T_{g(k)}}
 \Delta T_{g(k)}
+\frac{\partial {F}_{g(k+1/2)}}{\partial T_{g(k+1)}}
 \Delta T_{g(k+1)}
$$</span></p>
<p><span class="math display">$$
  F_{g(k+1/2)}^{\tau} =
\frac{k_{g(k+1/2)}}{\Delta z_{g(k+1/2)}}(T_{g(k+1)}^{\tau} - T_{g(k)}^{\tau})
$$</span></p>
<p><span class="math display">$$
 \frac{\partial {F}_{g(k+1/2)}}{\partial T_{g(k)}} =
- \frac{k_{g(k+1/2)}}{\Delta z_{g(k+1/2)}}
$$</span></p>
<p><span class="math display">$$
 \frac{\partial {F}_{g(k+1/2)}}{\partial T_{g(k+1)}} =
\frac{k_{g(k+1/2)}}{\Delta z_{g(k+1/2)}}
$$</span></p>
<p>and then add (1) to</p>
<p><span class="math display">$$
C_{g(k)} \frac{\Delta T_{g(k)}}{\Delta t_L}
= F_{g(k+1/2)}^* - {F}_{g(k-1/2)}^*  \\
= {F}_{g(k+1/2)}^{\tau}
+\frac{\partial F_{g(k+1/2)}}{\partial T_{g(k)}}
 \Delta T_{g(k)}
+\frac{\partial F_{g(k+1/2)}}{\partial T_{g(k+1)}}
 \Delta T_{g(k+1)}  \\
- F_{g(k-1/2)}^{\tau}
-\frac{\partial F_{g(k-1/2)}}{\partial T_{g(k-1)}}
 \Delta T_{g(k-1)}
-\frac{\partial F_{g(k-1/2)}}{\partial T_{g(k-1)}}
 \Delta T_{g(k)}
$$</span></p>
<p>and solved by the LU decomposition method as a series of <span class="math inline"><em>K</em><sub><em>g</em></sub></span> equations for <span class="math inline"><em>Δ</em><em>T</em><sub><em>g</em>(<em>k</em>)</sub> (<em>k</em> = 1, …, <em>K</em><sub><em>g</em></sub>)</span>. Note that the fluxes at the top and bottom of the soil are fixed as boundary conditions.</p>
<p><span class="math display"><em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup>*</sup> = <em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup><em>τ</em></sup> + <em>Δ</em><em>T</em><sub><em>g</em>(<em>k</em>)</sub></span></p>
<p>After correction for the phase change of soil moisture content, which will be described later, the soil temperature is completely updated.</p>
<h2 id="calculation-of-soil-moisture-transfer">Calculation of soil moisture transfer</h2>
<h3 id="equation-for-soil-moisture-transfer">Equation for Soil Moisture Transfer</h3>
<p>The equation for soil moisture transfer (Richards’ equation) is given by</p>
<p><span class="math display">$$
\rho_w \frac{w_{(k)}^{\tau+1} - w_{(k)}^{\tau}}{\Delta t_L} =
\frac{F_{w(k+1/2)} - F_{w(k-1/2)}}{\Delta z_{g(k)}} + S_{w(k)}
\qquad (k=1,\ldots,K_{g})
$$</span></p>
<p>Soil moisture flux <span class="math inline"><em>F</em><sub><em>w</em></sub></span> is given by</p>
<p><span class="math display">$$
 F_{w(k+1/2)} =
\left\{
\begin{array}{ll}
Pr^{***} - Et_{(1,1)}
 (k=0)\\
\displaystyle{
K_{(k+1/2)} \left(\frac{\psi_{(k+1)} - \psi_{(k)}}{\Delta z_{g(k+1/2)}} - 1 \right)
}
 (k=1,\ldots,K_{g}-1) \\
\displaystyle{
0
}
 (k=K_{g})
\end{array}
\right.
$$</span></p>
<p>where <span class="math inline"><em>K</em><sub>(<em>k</em> + 1/2)</sub></span> is the soil permeability coefficient based on Clapp and Hornberger (1978) and is given as follows</p>
<p><span class="math display"><em>K</em><sub>(<em>k</em> + 1/2)</sub> = <em>K</em><sub><em>s</em>(<em>k</em> + 1/2)</sub>(max (<em>W</em><sub>(<em>k</em>)</sub>, <em>W</em><sub>(<em>k</em> + 1)</sub>))<sup>2<em>b</em>(<em>k</em>) + 3</sup><em>f</em><sub><em>i</em></sub></span></p>
<p><span class="math inline"><em>K</em><sub><em>s</em>(<em>k</em> + 1/2)</sub></span> is the saturated hydraulic conductivity and <span class="math inline"><em>b</em><sub>(<em>k</em>)</sub></span> is the index of moisture potential curve as an external parameter for each soil type. <span class="math inline"><em>W</em><sub>(<em>k</em>)</sub></span> is the saturation degree excluding freezing soil moisture and is given by</p>
<p><span class="math display">$$
 W_{(k)} = \frac{w_{(k)}-w_{i(k)}}{w_{sat(k)}-w_{i(k)}}
$$</span></p>
<p><span class="math inline"><em>w</em><sub><em>s</em><em>a</em><em>t</em>(<em>k</em>)</sub></span> is the porosity of soil, which is also given as a parameter for each soil type. <span class="math inline"><em>f</em><sub><em>i</em></sub></span> is the parameter that indicates the suppression of soil moisture migration due to the presence of frozen soil, and is currently given as follows.</p>
<p><span class="math display"><em>f</em><sub><em>i</em></sub> = (1−<em>W</em><sub><em>i</em>(<em>k</em>)</sub>)(1−<em>W</em><sub><em>i</em>(<em>k</em> + 1)</sub>)</span></p>
<p>This parameter is <span class="math inline"><em>W</em><sub><em>i</em>(<em>k</em>)</sub> = <em>w</em><sub><em>i</em>(<em>k</em>)</sub>/(<em>w</em><sub><em>s</em><em>a</em><em>t</em>(<em>k</em>)</sub> − <em>w</em><sub><em>i</em>(<em>k</em>)</sub>)</span>.</p>
<p><span class="math inline"><em>ψ</em></span> is the soil moisture potential given by Clapp and Hornberger as follows</p>
<p><span class="math display"><em>ψ</em><sub>(<em>k</em>)</sub> = <em>ψ</em><sub><em>s</em>(<em>k</em>)</sub><em>W</em><sub>(<em>k</em>)</sub><sup> − <em>b</em>(<em>k</em>)</sup></span></p>
<p><span class="math inline"><em>ψ</em><sub><em>s</em>(<em>k</em>)</sub></span> is given as an external parameter for each soil type.</p>
<p>In (11), <span class="math inline"><em>S</em><sub><em>w</em>(<em>k</em>)</sub></span> is the source term and, considering the absorption and runoff by roots, is given by</p>
<p><span class="math display"><em>S</em><sub><em>w</em>(<em>k</em>)</sub> =  − <em>F</em><sub><em>r</em><em>o</em><em>o</em><em>t</em>(<em>k</em>)</sub> − <em>R</em><em>o</em><sub>(<em>k</em>)</sub></span></p>
<p>In (12), the boundary condition <span class="math inline"><em>F</em><sub><em>w</em>(1/2)</sub></span> is the difference between the water flux (<span class="math inline"><em>P</em><sup> *  * *</sup></span>) and the evaporation flux (<span class="math inline"><em>E</em><em>t</em><sub>(1, 1)</sub></span>) at the top of the soil through the runoff process. Apart from this, the sublimation flux is subtracted from the frozen soil moisture in the first layer prior to the calculation of soil moisture transfer.</p>
<p><span class="math display">$$
 w_{i(k)}^{\tau} = w_{i(k)}^{\tau} - Et_{(2,1)} \Delta t_L /(\rho \Delta z_{g(1)})\\
 w_{(k)}^{\tau} = w_{(k)}^{\tau} - Et_{(2,1)} \Delta t_L /(\rho \Delta z_{g(1)})
$$</span></p>
<h3 id="solving-the-soil-moisture-transfer-equation">Solving the soil moisture transfer equation</h3>
<p>These equations are solved from the first to the lowest layer using the implicit method. In other words, for <span class="math inline"><em>k</em> = 1, …, <em>K</em><sub><em>g</em></sub> − 1</span>, the soil moisture fluxes are estimated by</p>
<p><span class="math display">$$
  F_{w(k+1/2)}^{\tau+1} = F_{w(k+1/2)}^{\tau}
+\frac{\partial {F}_{w(k+1/2)}}{\partial w_{(k)}}
 \Delta w_{(k)}
+\frac{\partial {F}_{w(k+1/2)}}{\partial w_{(k+1)}}
 \Delta w_{(k+1)}
$$</span></p>
<p><span class="math display">$$
  F_{w(k+1/2)}^{\tau} =
K_{(k+1/2)} \left(\frac{\psi_{(k+1)}^{\tau} - \psi_{(k)}^{\tau}}{\Delta z_{g(k+1/2)}} - 1 \right)
$$</span></p>
<p><span class="math display">$$
 \frac{\partial {F}_{w(k+1/2)}}{\partial w_{(k)}} =
- \frac{K_{(k+1/2)}}{\Delta z_{g(k+1/2)}}
\left[
-b_{(k)} \frac{\psi_{s(k)}}{w_{sat(k)}-w_{i(k)}}W_{(k)}^{-b(k)-1}
\right]
$$</span></p>
<p><span class="math display">$$
 \frac{\partial {F}_{w(k+1/2)}}{\partial w_{(k+1)}} =
 \frac{K_{(k+1/2)}}{\Delta z_{g(k+1/2)}}
\left[
-b_{(k)} \frac{\psi_{s(k+1)}}{w_{sat(k+1)}-w_{i(k+1)}}W_{(k+1)}^{-b(k)-1}
\right]
$$</span></p>
<p>and (11) as</p>
<p><span class="math display">$$
\rho_w \Delta z_{g(k)} \frac{\Delta w_{(k)}}{\Delta t_L}
= F_{w(k+1/2)}^{\tau+1} - {F}_{w(k-1/2)}^{\tau+1} + S_{w(k)} \Delta z_{g(k)}  \\
= {F}_{w(k+1/2)}^{\tau}
+\frac{\partial F_{w(k+1/2)}}{\partial w_{(k)}}
 \Delta w_{(k)}
+\frac{\partial F_{w(k+1/2)}}{\partial w_{(k+1)}}
 \Delta w_{(k+1)}  \\
- F_{w(k-1/2)}^{\tau}
-\frac{\partial F_{w(k-1/2)}}{\partial w_{(k-1)}}
 \Delta w_{(k-1)}
-\frac{\partial F_{w(k-1/2)}}{\partial w_{(k-1)}}
 \Delta w_{(k)} + S_{w(k)} \Delta z_{g(k)}
$$</span></p>
<p>The equations are treated as follows for <span class="math inline"><em>Δ</em><em>T</em><sub><em>g</em>(<em>k</em>)</sub> (<em>k</em> = 1, …, <em>K</em><sub><em>g</em></sub>)</span>, and are solved by the LU decomposition method as a series of <span class="math inline"><em>K</em><sub><em>g</em></sub></span> equations for <span class="math inline"><em>Δ</em><em>T</em><sub><em>g</em>(<em>k</em>)</sub> (<em>k</em> = 1, …, <em>K</em><sub><em>g</em></sub>)</span>. Note that the fluxes at the top and bottom of the soil are fixed as boundary conditions.</p>
<p><span class="math display"><em>w</em><sub>(<em>k</em>)</sub><sup><em>τ</em> + 1</sup> = <em>w</em><sub>(<em>k</em>)</sub><sup><em>τ</em></sup> + <em>Δ</em><em>w</em><sub>(<em>k</em>)</sub></span></p>
<p>The soil moisture content is updated using the LU decomposition method.</p>
<p>If this calculation results in supersaturation of soil moisture, the supersaturation is removed by vertical adjustment. The supersaturation is not considered as runoff because this supersaturation is artificial and is caused by the solution of the vertical soil moisture transfer without information about the saturation. First, supersaturated soil moisture is applied from the second soil layer downward. Then, from the lowermost layer of soil to the uppermost layer, the supersaturated soil moisture is added to the uppermost layer. This operation results in the formation of a saturated layer near the bottom of the soil when soil moisture is sufficiently high to define the groundwater level (with a certain amount of water content of the ground surface in the vicinity of the lowest layer of soil (with a certain amount of water content of the ground surface in the vicinity of the lowest level of soil).</p>
<h2 id="phase-changes-in-soil-moisture.">Phase changes in soil moisture.</h2>
<p>As a result of the heat conduction in the soil, the phase change of soil moisture content is calculated when the temperature of the layer with liquid moisture is below <span class="math inline"><em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub> = 0<sup>∘</sup></span> C or when the temperature of the layer with solid moisture is above <span class="math inline"><em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub></span>. Assuming that the freezing rate of soil moisture in the <span class="math inline"><em>k</em></span>st layer is set to <span class="math inline"><em>Δ</em><em>w</em><sub><em>i</em>(<em>k</em>)</sub></span>,</p>
<p>In case of <span class="math inline"><em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup>*</sup> &lt; <em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub></span> and <span class="math inline"><em>w</em><sub>(<em>k</em>)</sub><sup><em>τ</em> + 1</sup> − <em>w</em><sub><em>i</em>(<em>k</em>)</sub><sup><em>τ</em></sup> &gt; 0</span> (frozen)</p>
<p><span class="math display">$$
\Delta w_{i(k)} = \min\left(
\frac{C_{g(k)}(T_{melt}-T_{g(k)}^*)}{l_m \rho_w \Delta z_{g(k)}}, \
w_{(k)}^{\tau+1}-w_{i(k)}^{\tau}
\right)
$$</span></p>
<p>In case of <span class="math inline"><em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup>*</sup> &gt; <em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub></span> and <span class="math inline"><em>w</em><sub><em>i</em>(<em>k</em>)</sub><sup><em>τ</em></sup> &gt; 0</span> (melting)</p>
<p><span class="math display">$$
\Delta w_{i(k)} = \max\left(
\frac{C_{g(k)}(T_{melt}-T_{g(k)}^*)}{l_m \rho_w \Delta z_{g(k)}}, \
-w_{i(k)}^{\tau}
\right)
$$</span></p>
<p>Update soil freezing moisture and soil temperature as follows.</p>
<p><span class="math display">$$
w_{i(k)}^{\tau+1} = w_{i(k)}^{\tau} + \Delta w_{i(k)} \\
T_{g(k)}^{\tau+1} = T_{g(k)}^* + l_m \rho_w \Delta z_{g(k)} \Delta w_{i(k)} / C_{g(k)}
$$</span></p>
<h3 id="ice-sheet-process.">Ice sheet process.</h3>
<p>If land cover type is ice-cover, return to <span class="math inline"><em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub></span> when soil temperature exceeds <span class="math inline"><em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub></span>.</p>
<p><span class="math display"><em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup><em>τ</em> + 1</sup> = min (<em>T</em><sub><em>g</em>(<em>k</em>)</sub><sup>*</sup>, <em>T</em><sub><em>m</em><em>e</em><em>l</em><em>t</em></sub>)</span></p>
<p>The rate of change in the amount of ice cover, <span class="math inline"><em>F</em><sub><em>i</em><em>c</em><em>e</em></sub></span>, is diagnosed as</p>
<p><span class="math display">$$
 F_{ice} = - Et_{(2,1)} - \frac{C_{g(k)}\max(T_{g(k)}^* - T_{melt},\ 0)}{l_m \Delta t_L}
$$</span></p>
<p>Translated with www.DeepL.com/Translator (free version)</p>
</body>
</html>
