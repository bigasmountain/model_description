# Snow Submodel MATSNW

Calculate the snowpack, snow temperature and snow albedo.

## Diagnosis of snow area ratio

In the case of small snow cover, the sub-grid snow cover is taken into account. The area fraction of snow cover, TERM00000, is a unique function of the snow cover, TERM00001,

     EQ=00000.

given in . The standard position is TERM00002=100\[kg/TERM00003\].

In practice, various factors, such as topography and differences in snowfall and snowmelt, are expected to affect the snow coverage ratio. For this purpose, the introduction of a sub-grid snow coverage model (SSNOWD) based on Liston (private communication) is under consideration.

TERM00004 is referred to at the beginning of the flux calculation section and is used to compute an area-weighted average of the various fluxes computed there as follows

     EQ=00001.

Here, TERM00005 and TERM00006 represent fluxes on a snow-free surface and a snow-covered surface, respectively. Actually, this operation is carried out through the flux coupler.

## Vertical division of the snowpack layer

In order to represent the vertical distribution of the snow temperature, the snow is divided into multiple layers and the temperature is defined for each layer when the snow cover is large. The number of layers is variable, and the number of layers is increased as the amount of snowfall increases. The number of layers is variable, and the number of layers increases as the amount of snowfall increases.

The number of layers and the mass of each layer are uniquely determined by the amount of snow cover. In this way, the mass of each layer is not a new forecast variable.

The mass of each layer (TERM00007 and TERM00007) is determined as follows (TERM00008 is the top layer).

     EQ=00038.
     EQ=00038.
     EQ=00038.

Here,

     EQ=00002.

and while TERM00009 represents the grid-averaged snow cover, TERM00010 represents the snow cover in the snow region. Note that the mass of each layer (TERM00011) is also a value for the snow cover and not a grid average. The unit for each layer is kg/TERM00012.

It is clear from the above that the standard number of snow layers (TERM00013) is as follows.

     EQ=00003.

## Calculating the snowpack.

The forecasting equation for snow cover is given by

     EQ=00004.

TERM00014 is snowfall flux after interception by canopy, TERM00015 is sublimation flux, TERM00016 is snowmelt, and TERM00017 is refreezing of snowmelt water or freezing of rainfall.

### Sublimation of the snowpack

First, we subtract the amount of sublimation and partially update the snowpack.

     EQ=00039.
     EQ=00039.

If, by chance, the sublimation is greater than the snow accumulation in the first layer, the remaining amount is subtracted from the lower layer. The same is true if the second layer is insufficient.

### Melting Snowpack.

Next, the heat conduction during the snow cover is calculated and the amount of snowmelt is determined. The method for calculating the heat conduction in the snowpack is described later. The temperature of the snow cover updated by heat conduction is set to TERM00018. If the temperature of the first snow layer is higher than TERM00019 C, the temperature of the first snow layer is fixed at TERM00020 and the calculation is redone. In this case, the energy convergence TERM00021 is calculated for the first layer. This is not a grid-averaged value, but a value for the snow cover area. The amount of snowmelt in the first layer is the same as that in the first layer,

     EQ=00005.

It is.

If the temperature in the second and lower levels is higher than TERM00022, the temperature is returned to TERM00023 and the internal energy of the temperature change is used to melt the snow. In other words,

     EQ=00006.

and added TERM00024 as a new

     EQ=00007.

The amount of snowmelt is defined in (11) and is obtained in the same way as in (11).

Update the mass of each layer by subtracting the amount of snowmelt.

     EQ=00008.

In the middle of these calculations, if all the layers are melted, the remainder of TERM00025 is given to the layer below to raise the temperature of the layer below. That is, the temperature of the lower layer is increased,

     EQ=00009.

     EQ=00010.

Here, TERM00026 is the specific heat of snow (ice). When all the snow cover is melted, TERM00027 is given to the soil.

The total snowmelt of the entire snowpack is the sum of the snowmelt in each layer (note that this is a grid average).

     EQ=00011.

Subtracting the amount of snowmelt, the snowpack is partially updated.

     EQ=00012.

### Freezing snowmelt water and rainfall in snowpack

The freezing of snowmelt and rainfall in the snowpack is calculated. For the snowmelt, the effect of the liquid water generated by the melting of the upper layers of snow on the refreezing of the lower layers of snow is taken into account. The amount of liquid water retained in the snowpack is not taken into account; it is assumed that all the liquid water either freezes in the snowpack or runs down the snowpack.

Liquid water fluxes at the top of the snow cover in snow regions,

     EQ=00013.

Here, the snow melt below the second layer of the snowpack is also flushed from the top of the snowpack. (As a practical matter, melting below the second layer is unlikely to occur in this case.)

The temperature of snowmelt water is considered to be 0 TERM00028 C, but the temperature of rainfall on the snowpack is assumed to be 0 TERM00029 C in terms of the toilet bowl. The latent heat of freezing water causes the temperature of the snow cover to rise, but if the temperature of a layer of snow cover rises to 0 TERM00030 C, water cannot freeze any higher and flows to the next layer below. In addition, there is an upper limit to the amount of water that can be frozen at a certain ratio to the mass of the snow cover at that layer. In other words, the freezing amount in a layer, TERM00031, is

     EQ=00014.

It is determined by the following formula. The TERM00032 is the liquid water flux flowing from the top of the TERM00033th layer of snow cover. The standard value of the TERM00034 is 0.1.

The temperature change in the snowpack is ,

     EQ=00015.

and update the mass to

     EQ=00016.

And update.

The total amount of freezing in the entire snowpack is the sum of the amount of freezing in each layer (but it is a grid average).

     EQ=00017.

Add the amount of freeze and partially update the snowpack.

     EQ=00018.

The liquid water that passes through the snowpack down to the bottom is given to the soil.

### Snowfall.

Finally, the amount of snowfall that has been intercepted by the canopy is added to obtain the final updated snowpack.

     EQ=00040.

However, when the temperature of the first layer of soil is higher than TERM00035 C, the snowfall is assumed to melt on the ground. In this case, the energy of the latent heat of melting is absorbed by the soil.

When snow accumulation occurs due to a snowfall in a grid where there has been no snowfall, the snow coverage ratio (TERM00036) is newly diagnosed based on (1), and snow temperature (TERM00037) is assumed to be equal to the temperature of the first layer of soil.

We also add the amount of snowfall to the mass of the first layer.

     EQ=00019.

### Redividing the snow layer and re-diagnosing the temperature

When the snow cover is updated, the area fraction is re-diagnosed by (1) and the mass of each layer is reconstructed by (3) TERM00038(5). The temperature of each layer is re-diagnosed so that the energy is conserved.

     EQ=00020.

Note that the variables are those subscripted with TERM00039 and TERM00040 are those before and after the reconstruction. TERM00041 is the percentage of the mass of the TERM00042 layer before the reconstruction that is contained in the TERM00043 layer after the reconstruction.

## Calculating heat transfer during snowfall.

### The Heat Transfer Equation in Snowpack

The prediction equation for snowfall temperature due to heat conduction during snow cover is as follows.

     EQ=00021.

where the heat transfer flux TERM00044 is given by

     EQ=00022.

TERM00045 is the thermal conductivity of the snow cover, which gives a constant value of 0.3 W/m/K in standard practice. TERM00046 is the thickness of each snow layer,

     EQ=00023.

The density of snow cover is defined by TERM00047 as 300 kg/TERM00048. TERM00047 is the density of the snow cover, and a constant value of 300 kg/TERM00048 is given in the standard definition. It is assumed that the density and thermal conductivity of the snowpack will change with the passage of time (aging) due to consolidation and alteration of the snowpack, but these effects are not taken into account here.

In (29), the flux TERM00049 at the top of the snowpack is the heat transfer flux TERM00050 determined at the surface energy balance, the surface energy convergence TERM00051 generated by melting the surface temperature under snow melting conditions, and the phase of water content in the canopy. In the case of a change, the energy is given using the energy correction TERM00052. We assume that the energy is given only for the snow covered surface (TERM00053) and that the energy is given uniformly for the grid (TERM00054). Since the sign of the fluxes is positively oriented upward, the convergence is negatively signified.

In the equation of snow flux (TERM00055), TERM00056 is the temperature at the bottom of the snowpack (i.e., the boundary between the snowpack and the soil). However, the flux from the first layer of soil to the bottom of the snowpack is

     EQ=00024.

Therefore, we assume that there is no flux convergence at the lower end of the snowpack,

     EQ=00025.

Substituting this into (33), we obtain the following

     EQ=00026.

### Case 1: If snowmelt does not occur in the first layer

The implicit method is used for the temperature of the first to lowest layer of snow cover. That is, the implicit method is used to determine the temperature from the first to the lowest layer of snow cover,

     EQ=00027.

     EQ=00028.

     EQ=00029.

     EQ=00030.

and put (28)

     EQ=00041.
     EQ=00041.
     EQ=00041.

The fluxes are treated as in the following equations, and are solved by the LU decomposition method as a series of coupled equations of TERM00058 and TERM00058 by the TERM00059 method. Note that the fluxes at the top of the snowpack are fixed as a boundary condition, and that the boundary condition at the bottom of the snowpack is the temperature of the first layer of soil, and that the fluxes at the bottom of the snowpack are explicitly treated as the temperature of the first layer of soil.

     EQ=00031.

Partially update the snowpack temperature by

### Case 2: When snowmelt occurs in the first layer

If the temperature of the first layer of snow cover melted in Case 1 is higher than the temperature of the first layer of snow cover melted in Case 1, snow melts in the first layer of snow cover. In this case, the temperature of the first snow layer is fixed at TERM00061 C. In other words, the temperature of the first snow layer is fixed from the second snow layer to the first snow layer. In other words, the flux from the second snow layer to the first snow layer is

     EQ=00032.

and solve as in case 1 (when there is only one layer of snow, the snow temperature is fixed in the flux from soil to snow in the same way).

The energy convergence used to melt the first layer of snow is given by

     EQ=00033.

Even if the temperature below the second layer of snow accumulation is higher than the TERM00062, the snow melting is not performed again, and the snow melting is processed as a correction.

## Generating Glaciers.

A maximum value is set for the snowpack, and the excess snowfall is considered to be glacial runoff.

     EQ=00034.

     EQ=00042.
     EQ=00042.

TERM00063 is the amount of glacial runoff. This mass is subtracted from the bottom of the snowpack. TERM00064 is given uniformly as 1000 kg/TERM00065 by default.

## Fluxes fed to the soil or runoff process

The heat flux to the soil through the snow accumulation process is as follows.

     EQ=00035.

TERM00066 is the energy convergence of the remaining snowpack, TERM00067 is the heat conduction flux in the lowest layer of the snowpack, and TERM00068 is the amount of snowfall that melted immediately after reaching the ground.

The energy correction term for the phase change of water on the canopy is given directly to the soil as follows.

     EQ=00036.

The water fluxes fed to the runoff process through the snow accumulation process are as follows.

     EQ=00043.
     EQ=00043.

TERM00069 is a flux of rainfall or snowmelt water that has passed through the lowest layer of snow cover.

## Snow albedo calculations.

The snow albedo is large in fresh snow, but decreases with time due to consolidation, deterioration and accumulation of dirt. In order to take this effect into account, snow albedo is treated as a predictor variable.

The time evolution of the "age" (age) of the snow cover follows Wiscombe and Warren (1980) and follows the following equation.

     EQ=00037.

TERM00070 = 5000, TERM00071 = 1 TERM00072 10 TERM00073. TERM00074 is a parameter for dirt adhesion, giving a value of TERM00075 on the ice sheet and TERM00076 at other locations.

With this, the albedo of the snowpack is ,

     EQ=00044.

This can be calculated by Here, TERM00077 is calculated backward from the predictor, TERM00078, using the same formula as above.

When there is a snowfall, the albedo is updated to the new snow value according to the amount of snowfall.

     EQ=00045.

TERM00079 is the amount of snow cover required for the albedo to return to a completely fresh snow value.
