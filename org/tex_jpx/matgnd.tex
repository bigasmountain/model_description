\section{土壌サブモデル MATGND}

土壌温度, 土壌水分および凍土の計算を行う.

\subsection{土壌中の熱伝導の計算}

\subsubsection{土壌中の熱伝導方程式}

土壌中の熱伝導による土壌温度の予報方程式は以下のようである.
\begin{verbatim}
EQ=00000.
\end{verbatim}
TERM00000 は土壌の熱容量であり, 以下で定義される.
\begin{verbatim}
EQ=00001.
\end{verbatim}
TERM00001 は土壌の比熱であり, 土壌タイプごとのパラメータとして与える.
TERM00002 は水の比熱, TERM00003 は土壌水分量(体積含水率)である.
TERM00004 は, 土壌第 TERM00005 層の厚さである.
このように, 土壌の熱容量に土壌水分の熱容量を含めると, 土壌水分移動に伴う
熱輸送を考慮しない限りエネルギーが保存しない.
現在, MATGND では土壌水分移動に伴う熱輸送は考慮されていないので, その導
入を検討している.
もっとも, 大気中の水蒸気や降水などの熱容量が考慮されない限り, 何らかの意
味ではエネルギーの保存が破れていることに注意されたい.

熱伝導フラックス TERM00006 は以下で与えられる.
\begin{verbatim}
EQ=00002.
\end{verbatim}
ここで, TERM00007 は土壌の熱伝導率であり, 以下のように与える.
\begin{verbatim}
EQ=00003.
\end{verbatim}
TERM00008 は土壌水分が TERM00009 のときの熱伝導率, TERM00010,
TERM00011 は定数である.

TERM00012 は, 第 TERM00013 層と第 TERM00014 層の土壌温度定義点の間の厚さで
ある (TERM00015 については, 第１層温度定義点と土壌上端, TERM00016 については,
最下層温度定義点と土壌下端の間の厚さ).

(3)において,
土壌上端の境界条件 TERM00017 は, 地表面エネルギーバランスを解いた際に
求めた値に, 積雪下端におけるエネルギー収束(積雪下端における熱伝導フラッ
クスを含む)およびキャノピー上水分の相変化によるエネルギー補正項の無雪面
への割り当て分を加えたものを与えている. フラックスは上向き正に取るため,
収束量を加える場合には負号が付く.
土壌下端の境界条件 TERM00018 はゼロフラックスとする.

\subsubsection{熱伝導方程式の求解}

これらの式を, 第１層から最下層までの土壌温度に関して陰解法を用いて解く.
すなわち, TERM00019,TERM00019 について, 熱伝導フラックスを
\begin{verbatim}
EQ=00004.
\end{verbatim}
\begin{verbatim}
EQ=00005.
\end{verbatim}
\begin{verbatim}
EQ=00006.
\end{verbatim}
\begin{verbatim}
EQ=00007.
\end{verbatim}
と置いて, (1)を
\begin{verbatim}
EQ=00022.
EQ=00022.
EQ=00022.
\end{verbatim}
のように扱い, TERM00020,TERM00020 についての
TERM00021 本の連立方程式として LU 分解法により解く.
この際, 土壌上端及び下端のフラックスは境界条件として固定して解くことに注
意されたい.
\begin{verbatim}
EQ=00008.
\end{verbatim}
により土壌温度を部分的に更新する.
これに, 後に述べる土壌水分の相変化による補正を経て, 土壌温度が完全に更新
される.

\subsection{土壌水分移動の計算}

\subsubsection{土壌水分移動の方程式}

土壌水分移動の方程式(Richards の式)は以下で与えられる.
\begin{verbatim}
EQ=00009.
\end{verbatim}

土壌水分フラックス TERM00022 は以下で与えられる.
\begin{verbatim}
EQ=00010.
\end{verbatim}
ここで, TERM00023 は土壌の透水係数であり, Clapp and Hornberger
(1978) を参考に以下のように与える.
\begin{verbatim}
EQ=00011.
\end{verbatim}
TERM00024 は飽和透水係数, TERM00025 は水分ポテンシャル曲線の指数で,
土壌タイプごとの外部パラメータとして与える.
TERM00026 は凍結土壌水分を除いて考えた飽和度で, 以下で与えられる.
\begin{verbatim}
EQ=00012.
\end{verbatim}
TERM00027 は土壌の空隙率で, これも土壌タイプごとのパラメータとして与
える. TERM00028 は凍土の存在により土壌水分の移動が抑制されることを表すパラメー
タで, 現在のところ以下のように与えているが, さらに検討を要する.
\begin{verbatim}
EQ=00013.
\end{verbatim}
TERM00029 である.

TERM00030 は土壌水分ポテンシャルで, Clapp and Hornberger により以下のように
与えられる.
\begin{verbatim}
EQ=00023.
\end{verbatim}
TERM00031 は土壌タイプごとの外部パラメータとして与える.

(11)において, TERM00032 はソース項であり, 根による吸い上げ
と流出を考慮して, 以下で与えられる.
\begin{verbatim}
EQ=00014.
\end{verbatim}

(12)において,
土壌上端の境界条件 TERM00033 は, 流出過程を経た水分フラックス
TERM00034 と土壌からの蒸発フラックス TERM00035 の差である.
これとは別に, 昇華フラックスの分は, 土壌水分移動の計算に先立って, 第１層
の凍結土壌水分から差し引く.
\begin{verbatim}
EQ=00024.
EQ=00024.
\end{verbatim}

\subsubsection{土壌水分移動方程式の求解}

これらの式を, 第１層から最下層までの土壌水分に関して陰解法を用いて解く.
すなわち, TERM00036,TERM00036 について, 土壌水分フラックスを
\begin{verbatim}
EQ=00015.
\end{verbatim}
\begin{verbatim}
EQ=00016.
\end{verbatim}
\begin{verbatim}
EQ=00017.
\end{verbatim}
\begin{verbatim}
EQ=00018.
\end{verbatim}
と置いて, (11)を
\begin{verbatim}
EQ=00025.
EQ=00025.
EQ=00025.
\end{verbatim}
のように扱い, TERM00037,TERM00037 についての
TERM00038 本の連立方程式として LU 分解法により解く.
この際, 土壌上端及び下端のフラックスは境界条件として固定して解くことに注
意されたい.
\begin{verbatim}
EQ=00019.
\end{verbatim}
により土壌水分量を更新する.

この計算の結果, 土壌水分量が過飽和になる部分が生じた場合, 鉛直方向に調節
を行い, 過飽和を除去する.
過飽和分を流出と見なさないのは, この過飽和が, 土壌水分の鉛直移動を飽和の
情報を持たずに解いたことによって生じた人工的なものだからである.
まず, 土壌第２層から下に向かって, 過飽和分の土壌水分量を一つ下の層へ与え
る.
次に, 土壌最下層から上へ向かって, 過飽和分の土壌水分量を一つ上の層へ与え
る.
この操作により, 土壌水分が十分に大きい場合, 土壌最下層付近に飽和層が形成
され, (\ref{roff_table})の地下水面が定義できる.

\subsection{土壌水分の相変化}

土壌中の熱伝導を計算した結果, 液体水分の存在する層の温度が TERM00039 C を下回った場合, もしくは固体水分の存在する層の温度が
TERM00040 を上回った場合には土壌水分の相変化を計算する.
すなわち, 第 TERM00041 層目の土壌水分の凍結量(調整分)を TERM00042 とすると,

TERM00043 かつ TERM00044 のとき
(凍結)
\begin{verbatim}
EQ=00020.
\end{verbatim}

TERM00045 かつ TERM00046 のとき(融解)
\begin{verbatim}
EQ=00021.
\end{verbatim}

土壌凍結水分量と土壌温度を以下のように更新する.
\begin{verbatim}
EQ=00026.
EQ=00026.
\end{verbatim}

\subsubsection{氷床過程}

土地被覆タイプが氷床である場合, 土壌温度が TERM00047 を越えたら
TERM00048 に戻す.
\begin{verbatim}
EQ=00027.
\end{verbatim}
このとき, 氷床量の変化率 TERM00049 を以下のように診断する.
\begin{verbatim}
EQ=00028.
\end{verbatim}
